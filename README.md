# NetSentry: A Lightweight Hybrid Intrusion Detection System

**NetSentry** is a lightweight, hybrid Intrusion Detection System (IDS) developed for local (SOHO) networks. It combines the speed of a **rule-based engine** for known threat detection with the adaptability of **unsupervised machine learning (K-Means clustering)** for anomaly detection.

This project demonstrates how signature-based and anomaly-based methods can act as complementary layers of defense in a resource-constrained environment.

---

## üöÄ Features

### 1. Rule-Based Engine (Real-Time)
The system monitors live traffic using `Scapy` and triggers immediate alerts for specific attack signatures:
* **Port Scan Detector:** Identifies when a single IP scans multiple ports within a short window.
* **TCP SYN Flood Detector:** Detects rapid-fire SYN packets indicative of a DoS attack.
* **Traffic Burst Detector:** Flags unusually high bandwidth usage (UDP floods).
* **ARP Spoof Detector:** Identifies discrepancies between IP and MAC address mappings.

### 2. Anomaly Detection Engine (Machine Learning)
Traffic logs are analyzed using a **K-Means clustering** model to identify "unknown" threats:
* **Unsupervised Learning:** Trains on benign traffic to learn a baseline of "normality."
* **Outlier Detection:** Flags packets that statistically deviate from the learned clusters.
* **Feature Analysis:** Utilizes packet length, protocol, and port numbers for clustering.

---

## üõ†Ô∏è Tech Stack

* **Language:** Python 3.x
* **Packet Sniffing:** Scapy
* **Data Processing:** Pandas, NumPy
* **Machine Learning:** Scikit-learn (K-Means, StandardScaler)
* **Visualization:** Matplotlib, Seaborn

---

## üì¶ Installation

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/yourusername/NetSentry.git](https://github.com/yourusername/NetSentry.git)
    cd NetSentry
    ```

2.  **Install dependencies:**
    ```bash
    pip install scapy pandas scikit-learn matplotlib seaborn
    ```

3.  **Network Setup:**
    * Ensure you have Npcap (Windows) or libpcap (Linux/macOS) installed.
    * **Note:** The script is configured to listen on the `Ethernet` interface. Change the `iface` argument in `sniffer.py` if using Wi-Fi (`Wi-Fi` or `wlan0`).

---

## üíª Usage

### Phase 1: Data Collection & Real-Time Detection

Run the main sniffer script with administrative privileges to capture traffic and detect attacks in real-time.

```bash
# Windows (Run as Administrator)
python sniffer.py

# Linux/Mac
sudo python3 sniffer.py
```
* **Normal Operation:** Browse the web to generate benign traffic.
* **Attack Simulation:** Use a separate machine or terminal to launch attacks (see *Testing* below).
* **Output:** Alerts will print to the console (`!!! ALERT !!!`), and all traffic is logged to `network_traffic.csv`.

### Phase 2: Anomaly Detection

Once you have collected data in `network_traffic.csv`, run the anomaly detector to train the model and evaluate its performance.

```bash
python anomaly_detector.py
```


This script will:

* Load and preprocess the CSV data.
* Determine the optimal *k* using the Elbow Method.
* Train the K-Means model on normal traffic.
* Test the model against the full dataset and output a Confusion Matrix and Performance Metrics.

---

## üß™ Testing & Attack Simulation

To validate the system, use the following tools from an attacker machine (e.g., a Kali Linux VM or WSL):

**1. Nmap Port Scan:**
```bash
nmap -Pn <TARGET_IP>
```

**2. TCP SYN Flood (hping3):**
```bash
sudo hping3 -S --flood -p 80 <TARGET_IP>
```

**3. UDP Traffic Burst (hping3):**
```bash
sudo hping3 --udp --flood -d 1000 <TARGET_IP>
```

**ARP Spoofing (arpspoof):**
```bash
sudo arpspoof -t <TARGET_IP> <ROUTER_IP>
```
## üìä Project Structure

* `sniffer.py`: Main entry point. Handles packet capture, rule-based logic, and CSV logging.
* `anomaly_detector.py`: Handles data loading, preprocessing, ML model training, and evaluation.
* `network_traffic.csv`: The dataset generated by the sniffer (contains both normal and alert labels).
* `README.md`: Project documentation.

---

## ‚ö†Ô∏è Disclaimer

**For Educational Purposes Only.**
This software is intended for use on networks you own or have explicit permission to test. Unauthorized use of network scanning and attack tools is illegal and unethical. The author is not responsible for any misuse of this tool.

---

## ü§ù Acknowledgments

Special thanks to the developers of **Scapy** and **Scikit-learn**.
